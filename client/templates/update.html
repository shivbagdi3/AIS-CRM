{% extends 'base_dash.html' %}
{% block content %}

<div class="container-fluid">
    <div class="row align-items-center justify-content-center">
        <div class="col-lg-12 col-md-6">
            <div class="card w-100 shadow-lg">
                <div class="card-body p-4">
                    <div class="row align-items-center">
                        <form method="post" id="myForm">
                            {% csrf_token %}
                            {% if msg is not None %}
                            <div id="danger-alert" class="alert alert-danger alert-dismissible fade show" role="alert">
                                <button type="button" class="btn-close" data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img"
                                    aria-label="Danger:">
                                    <use xlink:href="#exclamation-triangle-fill" />
                                </svg>
                                <div>
                                    {{ msg }}
                                </div>
                            </div>
                            {% endif %}
                            <div class="row align-items-center">
                                <div class="col-lg-12 col-md-6">
                                    <div class="row align-items-center">
                                        <div class="col-">
                                            <a href="{% url 'view-client' %}">
                                                <div>
                                                    <i class="ti ti-arrow-left" style="font-size: 30px;"></i><span
                                                        class="ms-2" style="font-weight: 600; font-size: 25px;">Client
                                                        details </span>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <br>
                            <div class="row align-items-center">
                                <div class="col-md-6 mb-2">
                                    <div class="form-outline">
                                        <label class="form-label" for="firstName">First
                                            Name</label>
                                        <input type="text" id="firstName" name="first_name"
                                            value="{{ client.first_name }}" class="form-control form-control-lg" />
                                    </div>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <div class="form-outline">
                                        <label class="form-label" for="lastName">Last Name</label>
                                        <input type="text" id="lastName" name="last_name" value="{{ client.last_name }}"
                                            class="form-control form-control-lg" />
                                    </div>
                                </div>
                            </div>
                            <div class="row align-items-center">
                                <div class="col-md-6">
                                    <div class="form-outline">
                                        <label class="form-label" for="phoneNumber">Phone
                                            Number</label>
                                        <input type="tel" id="phoneNumber" name="phone_num" value="{{ client.phone }}"
                                            class="form-control form-control-lg" />
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="row align-items-center justify-content-center mt-5">
                                        <p class="text-primary">
                                            {% if remaining_days %}
                                            {% if remaining_days > 0 %}
                                            Amc Expires in {{ remaining_days }} Days
                                            {% else %}
                                            Amc Expired {{
                                            remaining_days|add:0 }} Days ago
                                            {% endif %}
                                            {% else %}
                                            Amc not purchased
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div class="row align-items-center justify-content-center">
                                <div class="col-md-12 mb-2">
                                    <a data-bs-toggle="collapse" href="#Client" role="button" aria-expanded="false"
                                        aria-controls="collapseExample">
                                        Show Details
                                    </a>
                                </div>
                                <br>
                                <div class="collapse" id="Client">
                                    <div class="row justify-content-center">
                                        <div class="col-md-6 mb-2 pb-2">
                                            <div class="form-outline">
                                                <label class="form-label" for="emailAddress">Email</label>
                                                <input type="email" id="emailAddress" name="email"
                                                    value="{{ client.email }}" class="form-control form-control-lg" />
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2 d-flex align-items-center">
                                            <div class="form-outline w-100">
                                                <label for="birthdayDate" class="form-label">Company
                                                    Name</label>
                                                <input type="tel" name="company_name"
                                                    class="form-control form-control-lg"
                                                    value="{{ client.company_name }}" id="birthdayDate" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6 mb-2 d-flex align-items-center">
                                            <div class="form-outline w-100">
                                                <label for="birthdayDate" class="form-label">Alternative
                                                    No</label>
                                                <input type="tel" name="alternate_no"
                                                    class="form-control form-control-lg"
                                                    value="{{ client.Alternate_no }}" id="birthdayDate" />
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2">
                                            <div class="form-outline w-100">
                                                <label for="birthdayDate" class="form-label">GST
                                                    NO</label>
                                                <input type="text" name="GST_NO" class="form-control form-control-lg"
                                                    value="{{ client.GST_no }}" id="birthdayDate" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12 mb-4 d-flex align-items-center">
                                            <div class="form-outline w-100">
                                                <label for="birthdayDate" class="form-label">feedback</label>
                                                <textarea class="form-control" id="textAreaExample" name="feedback"
                                                    rows="3"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row align-items-center justify-content-center">
                                        <div class="col-lg-3 col-md-6 mb-2">
                                            <button class="btn btn-primary" type="submit" id="pills-home-tab2"
                                                data-mdb-toggle="pill" data-mdb-target="#pills-home2" type="button"
                                                role="tab" aria-controls="pills-home" aria-selected="true"><i
                                                    class="ti ti-user-up me-1"></i>
                                                Update
                                            </button>
                                        </div>
                                        <div class="col-lg-3 col-md-6 mb-2">
                                            <a href="{% url 'amc' client.id %}" class="btn btn-primary">
                                                <i class="ti ti-plus"></i>
                                                Update Amc
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 mt-2">
                                    <a data-bs-toggle="collapse" href="#Feedback" role="button" aria-expanded="false"
                                        aria-controls="collapseExample">
                                        Show Feedback
                                    </a>
                                </div>
                                <div class="collapse mt-4" id="Feedback">
                                    <div class="table-responsive mb-4">
                                        <table class="table text-nowrap mb-0 table-hover align-middle table-sm">
                                            <thead class="text-dark fs-4 text-center">
                                                <tr>
                                                    <th class="border-bottom-0">
                                                      <h6 class="fw-semibold mb-0">Sr No</h6>
                                                    </th>
                                                    <th class="border-bottom-0">
                                                      <h6 class="fw-semibold mb-0">Feedback</h6>
                                                    </th>
                                                    <th class="border-bottom-0">
                                                      <h6 class="fw-semibold mb-0">Feedback By</h6>
                                                    </th>
                                                  </tr>
                                            </thead>
                                            <tbody>
                                                {% if feedback %}
                                                {% for feedbacks in feedback %}
                                                <tr class="text-center">
                                                    <td class="border-bottom-0">
                                                        <h6 class="fw-semibold mb-0">{{ forloop.counter }}</h6>
                                                    </td>
                                                    <td class="border-bottom-0">
                                                        <h6 class="fw-semibold mb-1">{{ feedbacks.feed_back }}</h6>
                                                    </td>
                                                    <td class="border-bottom-0">
                                                        <h6 class="fw-semibold mb-1">{{ feedbacks.update_by.username }}</h6>
                                                    </td>
                                                </tr>
                                                {% endfor %}
                                                {% else %}
                                                <h2 class="text-center">No Feedback Available</h2>
                                                {% endif %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}